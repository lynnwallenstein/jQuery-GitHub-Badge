/*!
* jQuery GitHub Badge - v0.4 - 9/1/2012
*
* Copyright (c) 2012 Lynn Wallenstein
* Examples and docs at: http://tablesorter.com
* Dual licensed under the MIT and GPL licenses:
* http://www.opensource.org/licenses/mit-license.php
* http://www.gnu.org/licenses/gpl.html
*
* @author Lynn Wallenstein/lynn@lynn.io
* @contributor Rob Garrison/https://github.com/Mottie/
 */
;(function(c){window.console||function(){var a="log debug info warn error assert dir dirxml group groupEnd time timeEnd count trace profile profileEnd".split(" "),b;window.console={};for(b=0;b<a.length;b+=1)window.console[a[b]]=c.noop}();var f=function(a,b){return a.replace(/\{\{([\-_a-z]+)\}\}/g,function(a,c){return b[c]||"None"})},o=function(a,b){var i="https://api.github.com/users/"+b.login+"?callback=?",j="https://api.github.com/users/"+b.login+"/repos?callback=?",g=c(a).html(f('<div class="ghb_badge {{theme}}"><div class="ghb_badge_header"></div><div class="ghb--nav"><a class="ghb_user_info_nav chosen" rel="ghb_badge_user_info" href="#">User Info</a><a class="ghb_user_repo_nav" rel="ghb_badge_user_repos" href="#">Repos</a></div><div class="ghb_badge_user_info" style="display:none;"><h2>User Info</h2><div></div></div><div class="ghb_badge_user_repos" style="display:none;"><h2>Public {{user_badge_title}}</h2><ul class="ghb--repo-list"></ul><div class="ghb_repo_goto"></div></div></div>', b)),d=g.find(".ghb_badge_header"),k=g.find(".ghb_badge_user_info"),h=g.find(".ghb_repo_goto"),l=g.find(".ghb--repo-list");c.getJSON(i,function(a){var e=c.extend({},b,a.data);d.html(f('<h1><a target="_blank" href="http://github.com/{{login}}">{{login}}\'s GitHub</a> ({{public_repos}})</h1>',e));b.include_github_logo&&d.prepend(f('<a target="_blank" href="http://github.com"><img src="{{image_path}}ghb_logo.png" alt="GitHub"></a>',e));k.html(f('<img src="{{avatar_url}}" />{{name}}<dl><dt>Public Repos:</dt><dd><a target="_blank" href="http://github.com/{{login}}/repositories">{{public_repos}}</a></dd><dt>Followers:</dt><dd><a target="_blank" href="http://github.com/{{login}}/followers">{{followers}}</a></dd><dt>Following:</dt><dd><a target="_blank" href="http://github.com/{{login}}/following">{{following}}</a></dd><dt>Public Gists:</dt><dd><a target="_blank" href="http://gist.github.com/{{login}}">{{public_gists}}</a></dd></dl>', e));a.public_repos>b.repo_count?(e.remaining=a.public_repos-b.repo_count,h.html(f('<a href="http://github.com/{{login}}/repositories">View All {{user_badge_title}} ({{remaining}} More) ... </a>',e))):h.html('<a href="http://github.com/'+b.login+'">'+b.login+" at GitHub</a>");k.show()});c.getJSON(j,function(a){if(0===a.data.length)l.html('<li class="no_records">'+b.login+" Does Not Have Any Repos</li>");else{var e,d=[];c.each(a.data,function(a,c){e=f("date"===b.sort_on?'<li data-date="{{pushed_at}}" class="ghb_user_repo_item"><a target="_blank" href="{{html_url}}">{{name}}</a> <div>{{description}}</div></li>': '<li class="ghb_user_repo_item"><a target="_blank" href="{{html_url}}">{{name}}</a> <div>{{description}}</div></li>',c);c.fork&&(e=e.replace('class="','class="ghb_repo_fork '));d.push(e)});d.sort(function(b,a){b=b.toLowerCase();a=a.toLowerCase();return b===a?0:b>a?1:-1});"ascending"!==b.sorting&&d.reverse();a=b.repo_count-1;e=l.html(d.join("")).children().filter(":gt("+a+")").hide().end().filter(":first").addClass("firstrepo").end().eq(a).addClass("lastrepo").end();e.length>a&&h.append('<a href="#" class="ghb_show_more">Show '+ (e.length-a)+" more</a>").find(".ghb_show_more").click(function(){e.show();this.innerHTML="";return!1})}})},p=function(a,b){var i="https://api.github.com/repos/"+b.login+"/"+b.repo_name+"?callback=?",j="https://api.github.com/repos/"+b.login+"/"+b.repo_name+"/issues?state=open&callback=?",g="https://api.github.com/repos/"+b.login+"/"+b.repo_name+"/commits?callback=?",d=c(a).html(f('<div class="ghb_badge {{theme}}"><div class="ghb_badge_header"></div><div class="ghb_repo_nav"><a class="ghb_repo_info_nav chosen" rel="ghb_repo_info" href="#">Repo Info</a><a class="ghb_repo_commits_nav" rel="ghb_repo_commits" href="#">Commits</a><a class="ghb_repo_issues_nav" rel="ghb_repo_issues" href="#">Issues</a></div><div class="ghb_repo_info" style="display:none;"></div><div class="ghb_repo_issues" style="display:none;"><h2>Open Issues</h2><ul class="ghb_issue_list"></ul><div class="ghb_repo_goto_issues"></div></div><div class="ghb_repo_commits" style="display:none;"><h2>Commits</h2><ul class="ghb_commit_list"><li class="no_records">There are no commits in the {{repo_branch}} branch</li></ul><div class="ghb_repo_goto_commits"></div></div></div>', b)),k=d.find(".ghb_badge_header"),h=d.find(".ghb_repo_info"),l=d.find(".ghb_issue_list"),m=d.find(".ghb_repo_goto_issues").hide(),e=d.find(".ghb_repo_goto_commits").hide(),n=d.find(".ghb_commit_list");n.find(".no_commits");c.getJSON(i,function(a){a=a.data;k.html('<h1><a target="_blank" href="http://github.com/'+a.full_name+'">'+a.name+"</a></h1>");b.include_github_logo&&k.prepend(f('<a target="_blank" href="http://github.com"><img src="{{image_path}}ghb_logo.png" alt="GitHub"></a>',b));h.html(f('<p>{{description}}</p><p><a target="_blank" href="http://github.com/{{full_name}}">http://github.com/{{full_name}}</a></p><dl class="repo_info_list"><dt>Watchers:</dt><dd>{{watchers}}</dd><dt>Created:</dt><dd>{{created_at}}</dd><dt>Last Updated:</dt><dd>{{pushed_at}}</dd></dl>', a));m.html('<a href="http://github.com/'+a.full_name+'/issues">View All Issues</a>');e.html('<a href="http://github.com/'+a.full_name+'/commits">View All Commits</a>');h.show()});c.getJSON(j,function(a){if(a.data){m.show();var e=[];c.each(a.data,function(a,d){var i=c.extend({},b,d,d.user);e.push(f('<li><a target="_blank" href="{{html_url}}">{{title}}<span title="{{login}} @ {{created_at}}">by {{login}}</span></a><div>{{body}}</div></li>',i));if(a===b.issue_count-1)return!1});"ascending"!==b.sorting&& e.reverse();l.html(e.join("")).children().filter(":first").addClass("firstrepo").end().filter(":last").addClass("lastrepo")}else l.html('<li class="no_records">There are no open issues for this repo.</li>')});c.getJSON(g,function(a){var d=[];c.each(a.data,function(a,c){d.push('<li><a target="_blank" href="http://github.com/'+b.login+"/"+b.repo_name+"/commit/"+c.sha+'">'+c.commit.message+'<span title="'+c.committer.login+" @ "+c.commit.committer.date+'">by '+c.committer.login+"</span></a></li>");if(a=== b.commit_count-1)return!1});"ascending"!==b.sorting&&d.reverse();n.html(d.join("")).children().filter(":first").addClass("firstrepo").end().filter(":last").addClass("lastrepo");e.show()})};c.fn.GitHubBadge=function(a){var b=this,a=jQuery.extend({},c.fn.GitHubBadge.defaults,a);console.group("GitHubBadge");console.log("Options parsed as: %o",a);if(!a.login)return console.log("%s",a.login+" is undefined, not doing anything."),this;if("user"===a.kind)o(this,a);else if("project"===a.kind){if(!a.repo_name)return console.log("%s", a.repo_name+" is undefined, not doing anything."),this;p(this,a)}this.delegate(".ghb--nav a, .ghb_repo_nav a","click",function(f){f.preventDefault();var f=b.find(".chosen").removeClass("chosen").attr("rel"),j=c(this).addClass("chosen").attr("rel");b.find("."+f).hide();b.find("."+j)["slide"===a.animate_style?"slideDown":"show"]()});this.delegate("ul.ghb--repo-list li, ul.ghb_issue_list li","mouseenter",function(){c(this).find("div").show()});this.delegate("ul.ghb--repo-list li, ul.ghb_issue_list li", "mouseleave",function(){c(this).find("div").hide()});console.groupEnd();return this};c.fn.GitHubBadge.defaults={login:null,kind:"user",sort_on:"date",sorting:"ascending",theme:"github",include_github_logo:!0,image_path:"images/",animate_style:"slide",user_badge_title:"Repositories",repo_count:"10",show_repos:!0,repo_name:null,show_issues:!0,issue_count:"10",show_commits:!0,commit_count:"10"}})(jQuery);
