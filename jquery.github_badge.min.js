/*!
* jQuery GitHub Badge - v0.4 - 9/1/2012
*
* Copyright (c) 2012 Lynn Wallenstein
* Examples and docs at: http://tablesorter.com
* Dual licensed under the MIT and GPL licenses:
* http://www.opensource.org/licenses/mit-license.php
* http://www.gnu.org/licenses/gpl.html
*
* @author Lynn Wallenstein/lynn@lynn.io
* @contributor Rob Garrison/https://github.com/Mottie/
 */
/*
* JavaScript Pretty Date
* Modified 2013 by Alfred Xing (alfredxing.com)
* Copyright (c) 2011 John Resig (ejohn.org)
* Licensed under the MIT and GPL licenses.
*/
function prettyDate(a){a=new Date((a||"").replace(/-/g,"/").replace(/[TZ]/g," "));a=((new Date).getTime()-a.getTime())/1E3;var c=Math.floor(a/86400),b="Some time ago";switch(!0){case 60>a:b="Just now";break;case 120>a:b="1 minute ago";break;case 3600>a:b=Math.floor(a/60)+" minutes ago";break;case 7200>a:b="1 hour ago";break;case 86400>a:b=Math.floor(a/3600)+" hours ago";break;case 1==c:b="Yesterday";break;case 7>c:b=c+" days ago";break;case 31>c:b=Math.ceil(c/7)+" weeks ago";break;case 366>c:b=Math.floor(c/30)+" months ago";break;case 365<c:b=Math.floor(c/365)+" years ago"}return b}"undefined"!=typeof jQuery&&(jQuery.fn.prettyDate=function(){return this.each(function(){var a=prettyDate($(this).text());a&&$(this).text(a)})});
(function(b){if(!window.console){var l="log debug info warn error assert dir dirxml group groupEnd time timeEnd count trace profile profileEnd".split(" "),h;window.console={};for(h=0;h<l.length;h+=1)window.console[l[h]]=b.noop}var g=function(b,g){return b.replace(/\{\{([\-_a-z]+)\}\}/g,function(b,e){return g[e]||"None"})};b.fn.GitHubBadge=function(e){var h=this;e=jQuery.extend({},b.fn.GitHubBadge.defaults,e);console.group("GitHubBadge");console.log("Options parsed as: %o",e);if(!e.login)return console.log("%s",e.login+" is undefined, not doing anything."),this;if("user"===e.kind){var f=e,m="https://api.github.com/users/"+f.login+"?callback=?",n="https://api.github.com/users/"+f.login+"/repos?callback=?",j=b(this).html(g('<div class="ghb_badge {{theme}}"><div class="ghb_badge_header"></div><div class="ghb_user_nav"><a class="ghb_user_info_nav chosen" rel="ghb_badge_user_info" href="#">User Info</a><a class="ghb_user_repo_nav"        rel="ghb_badge_user_repos" href="#">Repos</a></div><div class="ghb_badge_user_info" style="display:none;"><h2>User Info</h2><div></div></div><div class="ghb_badge_user_repos" style="display:none;"><h2>Public {{user_badge_title}}</h2><ul class="ghb_repo_list"></ul><div class="ghb_repo_goto"></div></div></div>',f)),l=j.find(".ghb_badge_header"),q=j.find(".ghb_badge_user_info"),p=j.find(".ghb_repo_goto"),r=j.find(".ghb_repo_list");b.getJSON(m,function(a){var c=b.extend({},f,a.data);l.html(g('<h1><a target="_blank" href="http://github.com/{{login}}">{{login}}\'s GitHub</a> ({{public_repos}})</h1>',c));f.include_github_logo&&l.prepend(g('<a target="_blank" href="http://github.com"><img src="{{image_path}}ghb_logo.png" alt="GitHub"></a>',c));q.html(g('<img src="{{avatar_url}}" />{{name}}<dl><dt>Public Repos:</dt><dd><a target="_blank" href="http://github.com/{{login}}/repositories">{{public_repos}}</a></dd><dt>Followers:</dt><dd><a target="_blank" href="http://github.com/{{login}}/followers">{{followers}}</a></dd><dt>Following:</dt><dd><a target="_blank" href="http://github.com/{{login}}/following">{{following}}</a></dd><dt>Public Gists:</dt><dd><a target="_blank" href="http://gist.github.com/{{login}}">{{public_gists}}</a></dd></dl>',c));a.public_repos>f.repo_count?(c.remaining=a.public_repos-f.repo_count,p.html(g('<a href="http://github.com/{{login}}/repositories">View All {{user_badge_title}} ({{remaining}} More) ... </a>',c))):p.html('<a href="http://github.com/'+f.login+'">'+f.login+" at GitHub</a>");q.show()});b.getJSON(n,function(a){if(0===a.data.length)r.html('<li class="no_records">'+f.login+" Does Not Have Any Repos</li>");else{var c,d=[];b.each(a.data,function(a,b){c=g("date"===f.sort_on?'<li data-date="{{pushed_at}}" class="ghb_user_repo_item"><a target="_blank" href="{{html_url}}">{{name}}</a> <div>{{description}}</div></li>':'<li class="ghb_user_repo_item"><a target="_blank" href="{{html_url}}">{{name}}</a> <div>{{description}}</div></li>',b);b.fork&&(c=c.replace('class="','class="ghb_repo_fork '));d.push(c)});d.sort(function(a,b){a=a.toLowerCase();b=b.toLowerCase();return a===b?0:a>b?1:-1});"ascending"!==f.sorting&&d.reverse();a=f.repo_count-1;c=r.html(d.join("")).children().filter(":gt("+a+")").hide().end().filter(":first").addClass("firstrepo").end().eq(a).addClass("lastrepo").end();c.length>a&&p.append('<a href="#" class="ghb_show_more">Show '+(c.length-a)+" more</a>").find(".ghb_show_more").click(function(){c.show();this.innerHTML="";return!1})}})}else if("project"===e.kind){if(!e.repo_name)return console.log("%s",e.repo_name+" is undefined, not doing anything."),this;var d=e,m="https://api.github.com/repos/"+d.login+"/"+d.repo_name+"?callback=?",n="https://api.github.com/repos/"+d.login+"/"+d.repo_name+"/issues?state=open&callback=?",j="https://api.github.com/repos/"+d.login+"/"+d.repo_name+"/commits?callback=?",k=b(this).html(g('<div class="ghb_badge {{theme}}"><div class="ghb_badge_header"></div><div class="ghb_repo_nav"><a class="ghb_repo_info_nav chosen" rel="ghb_repo_info"    href="#">Repo Info</a><a class="ghb_repo_commits_nav"     rel="ghb_repo_commits" href="#">Commits</a><a class="ghb_repo_issues_nav"      rel="ghb_repo_issues"  href="#">Issues</a></div><div class="ghb_repo_info" style="display:none;"></div><div class="ghb_repo_issues" style="display:none;"><h2>Open Issues</h2><ul class="ghb_issue_list"></ul><div class="ghb_repo_goto_issues"></div></div><div class="ghb_repo_commits" style="display:none;"><h2>Commits</h2><ul class="ghb_commit_list"><li class="no_records">There are no commits in the {{repo_branch}} branch</li></ul><div class="ghb_repo_goto_commits"></div></div></div>',d)),s=k.find(".ghb_badge_header"),t=k.find(".ghb_repo_info"),u=k.find(".ghb_issue_list"),v=k.find(".ghb_repo_goto_issues").hide(),w=k.find(".ghb_repo_goto_commits").hide(),x=k.find(".ghb_commit_list");x.find(".no_commits");b.getJSON(m,function(a){a=a.data;s.html('<h1><a target="_blank" href="http://github.com/'+a.full_name+'">'+a.name+"</a></h1>");d.include_github_logo&&s.prepend(g('<a target="_blank" href="http://github.com"><img src="{{image_path}}ghb_logo.png" alt="GitHub"></a>',d));t.html(g('<p>{{description}}</p><p><a target="_blank" href="http://github.com/{{full_name}}">http://github.com/{{full_name}}</a></p><dl class="repo_info_list"><dt>Watchers:</dt><dd>{{watchers}}</dd><dt>Created:</dt><dd class="date">{{created_at}}</dd><dt>Last Updated:</dt><dd class="date">{{pushed_at}}</dd></dl>',a));v.html('<a href="http://github.com/'+a.full_name+'/issues">View All Issues</a>');w.html('<a href="http://github.com/'+a.full_name+'/commits">View All Commits</a>');t.show();b(".date").prettyDate()});b.getJSON(n,function(a){if(a.data){v.show();var c=[];b.each(a.data,function(a,e){var f=b.extend({},d,e,e.user);c.push(g('<li><a target="_blank" href="{{html_url}}">{{title}}<span title="{{login}} @ {{created_at}}">by {{login}}</span></a><div>{{body}}</div></li>',f));if(a===d.issue_count-1)return!1});"ascending"!==d.sorting&&c.reverse();u.html(c.join("")).children().filter(":first").addClass("firstrepo").end().filter(":last").addClass("lastrepo")}else u.html('<li class="no_records">There are no open issues for this repo.</li>')});b.getJSON(j,function(a){var c=[];b.each(a.data,function(a,b){c.push('<li><a target="_blank" href="http://github.com/'+d.login+"/"+d.repo_name+"/commit/"+b.sha+'">'+b.commit.message+'<span title="'+b.committer.login+" @ "+b.commit.committer.date+'">by '+b.committer.login+"</span></a></li>");if(a===d.commit_count-1)return!1});"ascending"!==d.sorting&&c.reverse();x.html(c.join("")).children().filter(":first").addClass("firstrepo").end().filter(":last").addClass("lastrepo");w.show()})}this.delegate(".ghb_user_nav a, .ghb_repo_nav a","click",function(a){a.preventDefault();a=h.find(".chosen").removeClass("chosen").attr("rel");var c=b(this).addClass("chosen").attr("rel");h.find("."+a).hide();h.find("."+c)["slide"===e.animate_style?"slideDown":"show"]()});this.delegate("ul.ghb_repo_list li, ul.ghb_issue_list li","mouseenter",function(){b(this).find("div").show()});this.delegate("ul.ghb_repo_list li, ul.ghb_issue_list li","mouseleave",function(){b(this).find("div").hide()});console.groupEnd();return this};b.fn.GitHubBadge.defaults={login:null,kind:"user",sort_on:"date",sorting:"ascending",theme:"github",include_github_logo:!0,image_path:"images/",animate_style:"slide",user_badge_title:"Repositories",repo_count:"10",show_repos:!0,repo_name:null,show_issues:!0,issue_count:"10",show_commits:!0,commit_count:"10"}})(jQuery);
